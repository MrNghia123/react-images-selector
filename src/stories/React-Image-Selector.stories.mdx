import { useState } from "react";
import { ArgsTable, Meta, Story, Canvas } from "@storybook/addon-docs";
import { action } from "@storybook/addon-actions";
import Checkbox from "@mui/material/Checkbox";
import Radio from "@mui/material/Radio";
import {
  ReactImageSelector,
  calculateCurrentSelections,
} from "../components/React-Image-Selector/react-image-selector";
import { RISImage } from "../components/React-Image-Selector/react-image-selector";

<Meta title="React Image Selector" component={ReactImageSelector} />

# React Image Selector

With `MDX` we can define a story for `React Image Selector` right in the middle of our markdown documentation. Defaults 4

export const availableImages = [
  { src: "./assets/chinstrap.jpg", value: "chinstrap" },
  { src: "./assets/emperor.jpg", value: "emperor" },
  { src: "./assets/king.jpg", value: "king" },
  { src: "./assets/little.jpg", value: "little" },
];

export const args = {
  multiple: true,
  imageStyles: {
    maxHeight: 300,
    maxWidth: 300,
    height: 150,
    width: 150,
  },
};

export const logEvent = (evt) => {
  action(evt.type)(evt.detail);
};

export const PrimaryTemplate = ({ multiple, imageStyles }) => {
  const [selectedImageValues, setSelectedImageValues] = useState(["emperor"]);
  const [materialControls, setMaterialControls] = useState(false);
  const docsMode = window.location.search.includes("viewMode=docs");
  const SelectorControl = multiple ? Checkbox : Radio;
  const handleOnPick = (image) => {
    const newSelections = multiple
      ? calculateCurrentSelections(image, selectedImageValues)
      : [image?.value];
    setSelectedImageValues(newSelections);
    logEvent({
      type: "onPick",
      detail: { imageSelected: image, newSelections },
    });
  };
  const handleMaterialControls = () => {
    setMaterialControls(!materialControls);
  };
  return (
    <>
      <ReactImageSelector
        availableImages={availableImages}
        selectedImages={selectedImageValues}
        onPick={handleOnPick}
        imageStyles={imageStyles}
        multiple={multiple}
        SelectorControl={
          materialControls && !docsMode ? SelectorControl : undefined
        }
      />
      <div
        style={{
          fontFamily: "Helvetica Neue,Helvetica,Arial,sans-serif",
          fontSize: 14,
          color: "#333333",
        }}
      >
        {!docsMode ? (
          <div>
            <div style={{ marginTop: "50px" }}>
              <label htmlFor="usematerial">
                <input
                  type="checkbox"
                  id="usematerial"
                  checked={materialControls}
                  onChange={handleMaterialControls}
                />
                Use Material {multiple ? "checkbox" : "radio button"} controls
              </label>
            </div>
            <div style={{ marginTop: 40 }}>
              <span style={{ fontSize: 25 }}>üí°</span> Use the Controls tab{" "}
              <span style={{ fontSize: 30 }}>üëá</span> to dynamically change
              props and see what they do to the component, and the Actions tab{" "}
              <span style={{ fontSize: 30 }}>üëá</span> to see what its returned
              to your handler function when you select images. Switch to the
              component's Docs tab <span style={{ fontSize: 30 }}>‚òù</span>
              for a fuller description of how the component works, including a code
              example.
            </div>
          </div>
        ) : null}
      </div>
    </>
  );
};

<Canvas>
  <Story name="Default" args={args}>
    {PrimaryTemplate.bind({})}
  </Story>
</Canvas>

## Props and Actions

<div style={{ fontSize: 14, color: "#333333" }}>
  <span style={{ fontSize: 25 }}>üí°</span> Switch to the Canvas Tab{" "}
  <span style={{ fontSize: 30 }}> ‚òù</span> to use the Controls feature, where
  you can dynamically change props and see what they do to the component.
</div>

You need to at least pass the `availableImages` prop (array of `ImageType`), otherwise your selector will have nothing to show üòâ ! `ImageType` is an object with two properties: `value` and `url`, both of type `String`.

### State

The selector componenent is stateless. You must pass in `selectedImages` (array of `String`) so the selector knows which images are currently selected.

### onPick Function handler

Because it's' stateless, the control cannot compute what your new selected images are. You must do that yourself and pass in a new `selectedImages` prop each time.

You must use your `onPick` function handler prop for this. This handler function will a single parameter, which is the image that was just selected (i.e. clicked). This `image` parameter is of type `ImageType` again. Your function must take this value, compute the new `selectedImages` value from it, and then pass it back to the selector control as an updated problem.

#### Computing the new `selectedImages` Prop

_How_ you compute the new `selectedImages` prop is entirely up to you.

If the selector is single image selector (prop `multiple` is false or not set at all) then it's easy: the image just clicked is now your selected image!

If it's a `multiple` selector, however, it's a bit more tricky. Remember, the `image` parameter passed to your `onPick` handler function contains no other selection information.  All you know is that image has just been clicked. The selector control doesn't click was to select the image or to unselect if it was already selected. You'll have to handle this in your own code.

### Props Table

<ArgsTable of={ReactImageSelector} />

## Github Repo

https://github.com/brownieboy/react-image-selector
